# mediasoup-go-demo

A demo application of [mediasoup-go](https://github.com/jiyeyuran/mediasoup-go).


## Configuration via query parameters

By adding query parameters into the URL you can set certain settings of the application:

| Parameter          | Type    | Description          | Default Value |
| ------------------ | ------- | -------------------- | ------------- |
| `roomId`           | String  | Id of the room      | Autogenerated  |
| `displayName`      | String  | Display name of your participant | Autogenerated |
| `handlerName`      | String  | Handler name of the mediasoup-client `Device` instance | Autodetected |
| `forceTcp`         | Boolean | Force RTC (audio/video/datachannel) over TCP instead of UDP | `false` |
| `produce`          | Boolean | Enable sending of audio/video | `true`  |
| `consume`          | Boolean | Enable reception of audio/video | `true` |
| `datachannel`      | Boolean | Enable DataChannels | `true` |
| `forceVP8`        | Boolean | Force VP8 codec for webcam and screen sharing | `false` |
| `forceH264`        | Boolean | Force H264 codec for webcam and screen sharing | `false` |
| `forceVP9`        | Boolean | Force VP9 codec for webcam and screen sharing | `false` |
| `forceAV1`        | Boolean | Force AV1 codec for webcam and screen sharing | `false` |
| `enableWebcamLayers` | Boolean | Enable simulcast or SVC for webcam | `true` |
| `enableSharingLayers` | Boolean | Enable simulcast or SVC for screen sharing | `true` |
| `webcamScalabilityMode` | String | `scalabilityMode` for webcam | 'L1T3' for VP8/H264 (in each simulcast encoding), 'L3T3_KEY' for VP9 |
| `sharingScalabilityMode` | String | `scalabilityMode` for screen sharing | 'L1T3' for VP8/H264 (in each simulcast encoding), 'L3T3' for VP9 |
| `numSimulcastStreams` | Number | Number of streams for simulcast in webcam and screen sharing | 3 |
| `info`             | Boolean | Display detailed information about media transmission | `false` |
| `faceDetection`    | Boolean | Run face detection | `false` |
| `externalVideo`    | Boolean | Send an external video instead of local webcam | `false` |
| `e2eKey`           | String | Key for media E2E encryption/decryption (just works with some OPUS and VP8 codecs) | |
| `consumerReplicas` | Number | Create artificial replicas of yourself and receive their audio and video (not displayed in the UI) | 0 |

## Installation

* Clone the project:

```bash
$ git clone https://github.com/jiyeyuran/mediasoup-go-demo.git
$ cd mediasoup-go-demo
```

* Set up the mediasoup-go-demo server:

```bash
$ cd server
$ go build
```

* Copy `config.example.json` as `config.json` and customize it for your scenario:

```bash
$ cp config.example.json config.json
```

**NOTE:** Make sure TLS certificates reside in `server/certs` directory with names `fullchain.pem` and `privkey.pem`.

* Set up the mediasoup-go-demo browser app:

```bash
$ cd app
$ npm install --legacy-peer-deps
```

## Run it locally

* Run the golang server application in a terminal:

```bash
$ cd server
$ MEDIASOUP_WORKER_BIN="the path to mediasoup-worker" ./server
```

* In a different terminal build and run the browser application:

```bash
$ cd app
$ npm start
```

* Enjoy.

## License

MIT
